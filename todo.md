-use ternary and list comprehensions

-factorise database class

-factorise Queue management